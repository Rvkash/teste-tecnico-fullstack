generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model categorias {
  id        BigInt     @id @default(autoincrement())
  nome      String     @db.VarChar(100)
  descricao String?
  criado_em DateTime?  @default(now()) @db.Timestamp(6)
  produtos  produtos[]
}

model produtos {
  id             BigInt      @id @default(autoincrement())
  categoria_id   BigInt?
  sku            String      @unique @db.VarChar(50)
  nome           String      @db.VarChar(255)
  estoque_minimo Int?        @default(0)
  marca          String?     @default("Generico") @db.VarChar(100)
  criado_em      DateTime?   @default(now()) @db.Timestamp(6)
  categorias     categorias? @relation(fields: [categoria_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  estoque        estoque?
  movimentacoes  estoque_movimentacoes[]
}


model estoque {
  id             BigInt   @id @default(autoincrement())
  produto_id     BigInt   @unique
  quantidade     Int      @default(0)
  atualizado_em  DateTime @default(now()) @updatedAt
  produto        produtos @relation(fields: [produto_id], references: [id], onDelete: Cascade)
}

model estoque_movimentacoes {
  id              BigInt   @id @default(autoincrement())
  produto_id      BigInt
  quantidade      Int      // Quantidade movimentada (sempre positiva)
  tipo            String   // 'ENTRADA' ou 'SAIDA'
  motivo          String?  //  Ex: "Venda", "Devolução", "Ajuste de inventário"
  criado_em       DateTime @default(now())
  produto         produtos @relation(fields: [produto_id], references: [id], onDelete: Cascade)
}


